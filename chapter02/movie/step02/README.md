의존성 - 상속 - 다형성

Movie는 기능을 수행하려면 인스턴스인 Amount와 Percent가 필요하지만, 
의존성을 보면 오직 추상 클래스인 DiscountPolicy에만 의존하고 있다. 

즉, 의존하고 있지 않지만 실행 시점에 협력이 가능한 이유는?
Movie의 생성자에서 DiscountPolicy로 받고 있음. 
따라서 실행 시에 그림이 새로 그려짐. AMountPolicy 클래스으 인스턴스에 의존하게끔. 

즉, 코드의 의존성과 실행 시점의 의존성은 다를 수 있다. 클래스 사이의 의존성과 객체 사이의 의존성은 동일하지 않을 수 있다. --> 객체 지향 설계의 특징. 

<의존의 양면성--> 설계가 트레이ㅡㄷ 오프의 산물>
이게 너무 많아지면 코드 이해하기 어려워짐. 
하지만 더 유연하고 확장 가능해진다. 

# 컴파일 시간 의존성과 실행 시간 의존성

# 상속 - 차이에 의한 프로그래밍 : 재사용 가능성

따라서 오버라이딩으로 부모 클래스와 다른 부분만을 추가해서 상속에해서 새로운 클래스를 쉽고 빠르게 만든느 방법을 차이에 의한 프로그래밍이라고 부른다. 

상속이 가치 있는 이유는 부모 클래스가 제공하는 모든 인터페이스를 자식 클래스가 물려받을 수 있기 때문이다.

인터페이스는 객체가 이해할 수 있는 메시지의 목록을 정의한다든 것을 기억하라. 

즉, 부모 클래스가 수신할 우 씨는 모든 메시지를 수신할 수 있기 떄문에 외부 객체는 자식 크래스를 부모 클래스와 동일한 타입으로 간주할 수 있다. 
--> 자식이 부모클래스를 대신하른ㄴ 것을 업캐스팅이라고 부른다. 그 이유는 클래스 다이어그램을 작성할 때 부모 클래스를 자식 클래스의 위에 위치시키기 때문ㅇ디ㅏ.  아래에 위치한 자식 클래스가 위에 위치한 부모 클래스로 자동적으로 타입 캐스팅되는 것처럼 보이기 때문에 업 캐스팅이라는 용어를 사용한다. 

메시지를 전송하면 실행되는 메서드는? 
동일한 메시지를 전송할 때 실제로 어떤 메서드가 실행될 것인지는 메시지를 수신하는 객체의 클래스가 무엇이냐에 따라 달라진다. 이를 다형성이라고 부른다.

다형적인 협력에 참여하는 객체들은 인터페이스가 동일해야한다. 
메시지와 메서드를 실행 시점에 바인딩한다는 것 = 지연 바인딩, 동적 바인딩.

초기 바인딩, 정적 바인딩

동적 프로그래밍 - 같은 메시지(계산)을 재계산하지 않고 재 사용하는 기법
동적 바인딩 - 같은 메시지를 실행 시점에 메서드와 바인딩하는 것. 

상속을 인터페이스 상속(서브타이핑)을 위해 사용해야 한다.

-> 변경에 취햑해질 수 있기 떄문.

인터페이스와 다형성
인터페이스와 내부 구현을 함께 상속받ㄹ도록 만듦

구현은 공유할 필요없이 순수하게 인터페잇므나 공유하고 싶을 때" 인터페이스라는 프로그래밍 요소 제공.

자바의 인터페이스는 말 그대로 구현에 대한 고려 없이 다형적인 협력에 참여하는 클래스들이 공유 가능한 외부 인터페이스 정의 한 것. 


추상 기반 클래스를 통해 자바의 인터페이스 개념을 구현할 수 있다.

추상 클래스를 이용해 다형성을 구현했던 할 인 정 책과 달리 구현을 공유할 필요가 없음.

인터페이스를 실체화하고 있는swaiemceCondition고 ㅏ{eropdCpndition은 동일한 인터페이스를 공유하며 다형적인 협력에 참여할 수 있다.}


업캐스팅이 적용되며, 협력은 다형적이다.

추상화의 장점
1. 요구사항의 정책을 높은 수준에서 서술할 수 있다 - 
영화 예매 요금은 최대 하나의 할인 정책과 다수의 할인 조건을 이용해 계산할 수 있다.

- 디자인 패턴이나 프레임워크 모두 추상화를 이용해 상위 정책을 정의함. 

2. 설계가 유연해진다. 기존의 구조를 수정하지 않고도 새로운 기능을 쉽게 추가하고 확장할 수 있다. 설계를 유연하게 만들 수 있다.


책임의 위치를 결정하기 위해 조건문을 사요한느 것은 협력의 설계 측면에서 대부분의 경우 좋지 않은 선택이다. 항상 예외 케이스를 최소화하고 일관성을 유지할 수 있는 방법을 선택하라.

따라서 0원이라는 할인 요금을 계산할 책임을 그대로 DiscountPolicy 계층에 유지시킨다. 

추상화를 중심으로 코드의 구조를 설계하면 유연하고 확장 가능한 설계를 만들 수 있다.

추상화가 유연한 설계를 간으하게 하는 이뉴는 설꼐가 구체적인 상황에 결합되는 것을 방지하기 때문이다. 


컨텍스트 독립성이라고 불리는 이 개념은 프레임워크와 같은 유연한 설계가 필수적인 분야에서 그 진가를 발휘한다
프레임워크에서 왜 필요할까를 생각해보면, dB를 쓰기 위해 mySQL을 사용할 수도, SQLITE3를 사용할 수도, Mongo DB를 사용할 수도 있으니까. DB 연결이다 라고 서술할 수 있게 만들어야해서가 아닐까?

유연성이 필요한 곳에 추상화를 사용하라.

상속이 설계에 주는 안 좋은 영향
1. 상속이 캡슐화를 위반한다는 것  --> 부모와 자식 클래스의 결합력, 변경에 취약.
2. 설계를 유연하지 못하게 만든다는 것 
--- 부모와 자식 사이의 관계를 컴파일 시점에 결정하기 때문에 실행 시점에 객체의 종류를 변경하는 거싱 불가능하다. 

배달의 민족에서 쿠폰을 줬는데, 그게 금액 할인 정책을 비율 할인 정책으로 ㅂ ㅕㄴ경해야해.

상속에서는 amount를 percent로 변경해야해. 